document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("grid-productos"),o=document.getElementById("buscador");e?fetch("productos_agrupados.json").then((e=>{if(!e.ok)throw new Error(`Error al cargar productos_agrupados.json (status ${e.status})`);return e.json()})).then((n=>{n.forEach((o=>{const n=function(e){if(!e.nombre||!Array.isArray(e.imagenes))return console.warn("Producto mal definido:",e),null;const o=document.createElement("div");o.classList.add("col","mb-5"),o.dataset.nombre=e.nombre.toLowerCase();const n=e.imagenes.length>0?e.imagenes[0]:"img/placeholder.png";return o.innerHTML=`\n      <div class="card h-100">\n        <img class="card-img-top" loading="lazy" src="${n}" alt="${e.nombre}" style="object-fit:cover;width:100%;height:200px;" />\n        <div class="card-body p-4">\n          <div class="text-center">\n            <h5 class="fw-bolder">${e.nombre}</h5>\n            ${null!=e.precio?`<span class="text-success fw-bold">$${e.precio.toFixed(2)}</span>`:""}\n          </div>\n        </div>\n        <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">\n          <div class="text-center">\n            <a class="btn btn-outline-dark mt-auto" href="#">Añadir</a>\n          </div>\n        </div>\n      </div>`,o}(o);n&&e.appendChild(n)})),o&&o.addEventListener("input",(o=>{const n=o.target.value.toLowerCase();e.querySelectorAll("[data-nombre]").forEach((e=>{e.style.display=e.dataset.nombre.includes(n)?"":"none"}))}))})).catch((o=>{console.error("No se pudieron cargar los productos agrupados:",o),e.innerHTML='<div class="col-12"><p class="text-center text-muted">No se encontraron productos disponibles.</p></div>'})):console.error('No se encontró el contenedor de productos (id="grid-productos")')}));