From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Codex <codex@openai.com>
Date: Wed, 05 Jun 2025 14:00:00 -0300
Subject: [PATCH] Limpieza y optimización del proyecto

---
 .gitignore                                       |  14 +++++++++++---
 index.html                                        | 138 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++------------------
 js/scripts.js                                     | 135 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-------
 manifest.json                                     |  44 +++++++++++++++++++++++++++++++++++++++++++++
 scripts/optimize-images.js                        |  60 ++++++++++++++++++++++++++++++++++++++++++++++++++
 produtos_agrupados.json                            |  10 +++++++---
 7 files changed, 339 insertions(+), 62 deletions(-)
 create mode 100644 manifest.json
 create mode 100644 scripts/optimize-images.js

diff --git a/.gitignore b/.gitignore
index e69de29..f3d2c3a 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,6 +1,17 @@
 # Node modules
 node_modules/
+
+# Dependencias de desarrollo
+dist/**/*.map
+css/*.map
+js/*.map
+
+# Cachés de sistema
 .DS_Store
 Thumbs.db
 
+# Imágenes originales pesadas
+img/originals/
+
+# Archivos de log
+*.log
diff --git a/index.html b/index.html
index 34f12ab..abc1234 100644
--- a/index.html
+++ b/index.html
@@ -1,6 +1,34 @@
 <!DOCTYPE html>
 <html lang="es">
   <head>
+    <!-- META SEO & PWA -->
+    <meta charset="utf-8" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <meta name="description" content="Relive – Catálogo de Accesorios" />
+    <meta name="author" content="Relive" />
+    <meta property="og:title" content="Relive – Catálogo de Accesorios" />
+    <meta property="og:description" content="Servicio técnico y venta de accesorios para celulares en Pinamar, Canelones, Uruguay." />
+    <meta property="og:image" content="https://tu-dominio.com/img/og-portada.jpg" />
+    <meta property="og:url" content="https://tu-dominio.com/" />
+    <meta name="theme-color" content="#ff6600" />
+    <link rel="manifest" href="manifest.json" />
+    <link rel="apple-touch-icon" href="assets/icon-192.png" />
+
     <title>Relive – Catálogo de Accesorios</title>
 
-    <!-- Bootstrap Icons (CDN) -->
-    <link
-      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
-      rel="stylesheet"
-    />
-
-    <!-- Bootstrap CSS (ya compilado en css/styles.css) -->
-    <link href="css/styles.css" rel="stylesheet" />
-
-    <!-- TU CSS personalizado: grid de tarjetas, colores, etc. -->
-    <link href="css/estilos.css" rel="stylesheet" />
+    <!-- Bootstrap CSS desde CDN -->
+    <link
+      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
+      rel="stylesheet"
+      integrity="sha384-gHxcMv1XQqI/VHMiLhQ6pbxJNRHGm8XwG6L7xyXoYbdofrLJRAJco4bdZkpV1kmV"
+      crossorigin="anonymous"
+    />
+    <!-- CSS personalizado minificado -->
+    <link href="css/estilos.min.css" rel="stylesheet" />
   </head>
 
   <body>
@@ -30,29 +58,44 @@
         <button class="btn btn-outline-dark" type="submit">
           <i class="bi-cart-fill me-1"></i>
           Cart
           <span class="badge bg-dark text-white ms-1 rounded-pill">0</span>
         </button>
       </form>
     </div>
   </nav>
 
   <!-- Header -->
   <header class="bg-dark py-5">
     <div class="container px-4 px-lg-5 my-5">
       <div class="text-center text-white">
         <h1 class="display-4 fw-bolder">Servicio técnico Relive</h1>
         <p class="lead fw-normal text-white-50 mb-0">
           Reparación y venta de accesorios para celulares
         </p>
       </div>
     </div>
   </header>

-  <!-- Section: Catálogo dinámico -->
-  <section class="py-5">
-    <div class="container px-4 px-lg-5 mt-5">
-      <!-- Este <div> es donde el JS inyectará cada tarjeta de producto -->
-      <div
-        id="grid-productos"
-        class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center"
-      >
-        <!-- Aquí se inyectan dinámicamente las tarjetas desde js/main.js -->
-      </div>
-    </div>
-  </section>
+  <!-- Section: Buscador y Catálogo dinámico -->
+  <section class="py-5">
+    <div class="container px-4 px-lg-4 mt-5">
+      <!-- Campo de búsqueda -->
+      <div class="mb-4">
+        <input
+          id="buscador"
+          type="text"
+          class="form-control"
+          placeholder="Buscar producto…"
+        />
+      </div>
+      <!-- Contenedor donde JS inyectará las tarjetas -->
+      <div
+        id="grid-productos"
+        class="row gx-4 gx-lg-5 row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-xl-4 justify-content-center"
+      >
+        <!-- Tarjetas generadas dinámicamente -->
+      </div>
+    </div>
+  </section>

   <!-- Footer -->
   <footer class="py-5 bg-dark">
     <div class="container">
       <p class="m-0 text-center text-white">
         © 2025 Relive · Servicio técnico móvil en Pinamar, Canelones, Uruguay
       </p>
     </div>
   </footer>

   <!-- Bootstrap JS Bundle (Popper + Bootstrap JS) desde CDN -->
   <script
     src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
     integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
     crossorigin="anonymous"
   ></script>

-  <!-- JS del tema (scripts.js) -->
-  <script src="js/scripts.js"></script>
+  <!-- JS principal minificado -->
+  <script src="js/main.min.js"></script>

   <!-- Acceso rápido a WhatsApp (opcional; actualiza el número) -->
   <a
     href="https://wa.me/598XXXXXXXX"
     target="_blank"
     style="position: fixed; bottom: 20px; right: 20px;"
   >
     <img
       src="https://img.icons8.com/color/48/000000/whatsapp--v1.png"
       alt="WhatsApp"
     />
   </a>
 </body>
 </html>
diff --git a/js/scripts.js b/js/scripts.js
index d41d8cd..abc1234 100644
--- a/js/scripts.js
+++ b/js/scripts.js
@@ -0,0 +1,127 @@
+// js/scripts.js
+// Lógica combinada para carga dinámica de productos y filtrado
+
+document.addEventListener('DOMContentLoaded', () => {
+  const contenedor = document.getElementById('grid-productos');
+  const buscador = document.getElementById('buscador');
+
+  if (!contenedor) {
+    console.error('No se encontró el contenedor de productos (id="grid-productos")');
+    return;
+  }
+
+  let todosProductos = [];
+
+  // 1. Cargar JSON agrupado
+  fetch('productos_agrupados.json')
+    .then(response => {
+      if (!response.ok) {
+        throw new Error(`Error al cargar productos_agrupados.json (status ${response.status})`);
+      }
+      return response.json();
+    })
+    .then(productos => {
+      todosProductos = productos;
+      mostrarProductos(productos);
+    })
+    .catch(err => {
+      console.error('No se pudieron cargar los productos agrupados:', err);
+      contenedor.innerHTML = `
+        <div class="col-12">
+          <p class="text-center text-muted">No se encontraron productos disponibles.</p>
+        </div>
+      `;
+    });
+
+  // 2. Función para mostrar tarjetas en pantalla
+  function mostrarProductos(lista) {
+    contenedor.innerHTML = '';
+    lista.forEach(prod => {
+      // Validar campos mínimos
+      if (!prod.nombre || !Array.isArray(prod.imagenes)) return;
+
+      const col = document.createElement('div');
+      col.classList.add('col', 'mb-5');
+
+      const primeraImagen =
+        prod.imagenes.length > 0
+          ? prod.imagenes[0]
+          : 'img/placeholder.png';
+
+      col.innerHTML = `
+        <div class="card h-100">
+          <img
+            class="card-img-top"
+            src="${primeraImagen}"
+            alt="${prod.nombre}"
+            loading="lazy"
+            style="object-fit: cover; width: 100%; height: 200px;"
+          />
+          <div class="card-body p-4">
+            <div class="text-center">
+              <h5 class="fw-bolder">${prod.nombre}</h5>
+              ${
+                prod.precio != null
+                  ? `<span class="text-success fw-bold">$${prod.precio.toFixed(2)}</span>`
+                  : ''
+              }
+            </div>
+          </div>
+          <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
+            <div class="text-center">
+              <a class="btn btn-outline-dark mt-auto btn-add" href="#" data-producto-id="${prod.nombre}">Añadir</a>
+            </div>
+          </div>
+        </div>
+      `;
+      contenedor.appendChild(col);
+    });
+  }
+
+  // 3. Filtrado en tiempo real mediante buscador
+  if (buscador) {
+    buscador.addEventListener('input', e => {
+      const texto = e.target.value.toLowerCase();
+      const filtrados = todosProductos.filter(prod =>
+        prod.nombre.toLowerCase().includes(texto)
+      );
+      mostrarProductos(filtrados);
+    });
+  }
+
+  // 4. Event delegation para “Añadir al carrito”
+  contenedor.addEventListener('click', e => {
+    const btn = e.target.closest('.btn-add');
+    if (!btn) return;
+    e.preventDefault();
+    const productoId = btn.dataset.productoId;
+    console.log(`Agregar al carrito: ${productoId}`);
+    // Aquí podrías llamar a una función agregarAlCarrito(productoId)
+  });
+});
diff --git a/manifest.json b/manifest.json
new file mode 100644
index 0000000..def4567
--- /dev/null
+++ b/manifest.json
@@ -0,0 +1,44 @@
+{
+  "short_name": "Relive",
+  "name": "Servicio técnico Relive",
+  "icons": [
+    {
+      "src": "assets/icon-192.png",
+      "sizes": "192x192",
+      "type": "image/png"
+    },
+    {
+      "src": "assets/icon-512.png",
+      "sizes": "512x512",
+      "type": "image/png"
+    }
+  ],
+  "start_url": "./index.html",
+  "display": "standalone",
+  "theme_color": "#ff6600",
+  "background_color": "#ffffff"
+}
diff --git a/scripts/optimize-images.js b/scripts/optimize-images.js
new file mode 100644
index 0000000..abc9def
--- /dev/null
+++ b/scripts/optimize-images.js
@@ -0,0 +1,60 @@
+/**
+ * scripts/optimize-images.js
+ * Comprime JPG/PNG de img/img_accesorios/** a WebP 80% en img/optimized/
+ */
+const sharp = require('sharp');
+const fs = require('fs');
+const path = require('path');
+
+// Carpeta base de imágenes originales
+const carpetaOriginal = path.join(__dirname, 'img', 'img_accesorios');
+// Carpeta destino para imágenes comprimidas
+const carpetaOptimizada = path.join(__dirname, 'img', 'optimized');
+
+// Crear carpeta optimizada si no existe
+if (!fs.existsSync(carpetaOptimizada)) {
+  fs.mkdirSync(carpetaOptimizada, { recursive: true });
+}
+
+/**
+ * Función recursiva para procesar la carpeta de imágenes
+ */
+function optimizarCarpeta(folder) {
+  const items = fs.readdirSync(folder);
+  items.forEach(item => {
+    const rutaCompleta = path.join(folder, item);
+    const estad = fs.statSync(rutaCompleta);
+    if (estad.isDirectory()) {
+      // Si es subcarpeta, creamos análogo en carpetaOptimizada y procesamos recursivamente
+      const nuevaRuta = rutaCompleta.replace(carpetaOriginal, carpetaOptimizada);
+      if (!fs.existsSync(nuevaRuta)) {
+        fs.mkdirSync(nuevaRuta, { recursive: true });
+      }
+      optimizarCarpeta(rutaCompleta);
+    } else if (estad.isFile()) {
+      const ext = path.extname(item).toLowerCase();
+      if (ext === '.jpg' || ext === '.jpeg' || ext === '.png') {
+        const relPath = path.relative(carpetaOriginal, rutaCompleta);
+        const outputWebp = path.join(carpetaOptimizada, relPath.replace(ext, '.webp'));
+        // Asegurar carpeta destino
+        const outputDir = path.dirname(outputWebp);
+        if (!fs.existsSync(outputDir)) {
+          fs.mkdirSync(outputDir, { recursive: true });
+        }
+        // Comprimir y guardar como WebP
+        sharp(rutaCompleta)
+          .webp({ quality: 80 })
+          .toFile(outputWebp)
+          .then(() => {
+            console.log(`Optimizada: ${relPath} → ${path.relative(__dirname, outputWebp)}`);
+          })
+          .catch(err => {
+            console.error(`Error al optimizar ${relPath}:`, err);
+          });
+      }
+    }
+  });
+}
+
+// Ejecutar optimización
+optimizarCarpeta(carpetaOriginal);
diff --git a/productos_agrupados.json b/productos_agrupados.json
index 1234abc..5678def 100644
--- a/productos_agrupados.json
+++ b/productos_agrupados.json
@@ -1,10 +1,17 @@
 [
   {
     "nombre": "Auricular Tipo C",
-    "imagenes": [
-      "img/img_accesorios/Auriculares/Auricular_tipo_c/imagen1.jpg",
-      "img/img_accesorios/Auriculares/Auricular_tipo_c/imagen2.jpg"
-    ],
+    "imagenes": [
+      "img/optimized/Auriculares/Auricular_tipo_c/imagen1.webp",
+      "img/optimized/Auriculares/Auricular_tipo_c/imagen2.webp"
+    ],
     "precio": null
   },
   {
     "nombre": "Manos Libres JBL T500 - Negro (JBLT500BLKAM)",
-    "imagenes": [
-      "img/img_accesorios/Auriculares/Auriculares_3.5mm/Manos Libres JBL T500 - Negro (JBLT500BLKAM)/imagen1.jpg"
-    ],
+    "imagenes": [
+      "img/optimized/Auriculares/Auriculares_3.5mm/Manos Libres JBL T500 - Negro (JBLT500BLKAM)/imagen1.webp"
+    ],
     "precio": null
   }
 ]
\ No newline at end of file
---
